# üîê Security Policy

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —É—Ç–µ—á–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∞–ª **–ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ WireGuard** –∏ **–ø–∞—Ä–æ–ª–∏** –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–º–∏—Ç–æ–≤. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –Ω–∏–∂–µ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã.

---

## üö® –®–∞–≥ 1: –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π

–í—Å–µ peer-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –ø–æ–ø–∞–≤—à–∏–µ –≤ GitHub, **–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω—ã**:

### –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –∫–ª–∏–µ–Ω—Ç—ã:
- ‚úÖ `laptop-grisha` (–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –≤ `laptop-grisha.conf`)
- ‚úÖ `phone-grisha` (QR-–∫–æ–¥ —Å –∫–ª—é—á–æ–º –≤ `phone-grisha-qr.png`)
- ‚úÖ `marina-iphone` (QR-–∫–æ–¥ —Å –∫–ª—é—á–æ–º –≤ `marina-iphone-qr.png`)

### –î–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@31.28.27.96

# 2. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
cd /opt/vpn
docker compose down

# 3. –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ peer-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
rm -rf config/peer_laptop-grisha
rm -rf config/peer_phone-grisha
rm -rf config/peer_marina-iphone

# 4. –û–±–Ω–æ–≤–∏—Ç–µ PEERS –≤ docker-compose.yml (–ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ –∑–∞–Ω–æ–≤–æ —Ç–µ—Ö –∂–µ –∫–ª–∏–µ–Ω—Ç–æ–≤)
# –≠—Ç–æ –∑–∞—Å—Ç–∞–≤–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ –∫–ª—é—á–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose up -d

# 6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤
docker logs wireguard
ls -la config/
```

### –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤:

```bash
# –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö - –ø–æ–∫–∞–∂–∏—Ç–µ –Ω–æ–≤—ã–π QR-–∫–æ–¥ —á–µ—Ä–µ–∑ SSH:
docker exec wireguard cat /config/peer_phone-grisha/peer_phone-grisha.conf | qrencode -t ansiutf8

# –î–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ - —Å–∫–∞—á–∞–π—Ç–µ —á–µ—Ä–µ–∑ SCP:
scp root@31.28.27.96:/opt/vpn/config/peer_laptop-grisha/peer_laptop-grisha.conf ~/Desktop/
```

**‚ö†Ô∏è –°—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–æ–ª—å—à–µ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ—Å–ª–µ —Ä–æ—Ç–∞—Ü–∏–∏!**

---

## üßπ –®–∞–≥ 2: –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ Git

### –í–∞—Ä–∏–∞–Ω—Ç A: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `git filter-repo` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ git-filter-repo
pip install git-filter-repo

# 2. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∑–∞–Ω–æ–≤–æ
git clone https://github.com/DREDGV/pocket-portal.git
cd pocket-portal

# 3. –£–¥–∞–ª–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –≤—Å–µ–π –∏—Å—Ç–æ—Ä–∏–∏
git filter-repo --path laptop-grisha.conf --invert-paths
git filter-repo --path marina-iphone-qr.png --invert-paths
git filter-repo --path phone-grisha-qr.png --invert-paths
git filter-repo --path .env --invert-paths

# 4. Force-push –≤ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git remote add origin https://github.com/DREDGV/pocket-portal.git
git push --force --all
git push --force --tags
```

### –í–∞—Ä–∏–∞–Ω—Ç B: BFG Repo-Cleaner (–±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤)

```bash
# 1. –°–∫–∞—á–∞–π—Ç–µ BFG: https://rtyley.github.io/bfg-repo-cleaner/
java -jar bfg.jar --delete-files laptop-grisha.conf pocket-portal.git
java -jar bfg.jar --delete-files "*-qr.png" pocket-portal.git
java -jar bfg.jar --delete-files .env pocket-portal.git

# 2. –û—á–∏—Å—Ç–∏—Ç–µ –∏ push
cd pocket-portal.git
git reflog expire --expire=now --all
git gc --prune=now --aggressive
git push --force
```

**–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏:**
- –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∫–ª–æ–Ω—ã.
- –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ–ª–∂–Ω—ã —Å–¥–µ–ª–∞—Ç—å `git clone` –∑–∞–Ω–æ–≤–æ (–Ω–µ `git pull`!).

---

## üõ°Ô∏è –®–∞–≥ 3: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –±—É–¥—É—â–∏—Ö —É—Ç–µ—á–µ–∫

‚úÖ **`.gitignore` —É–∂–µ –æ–±–Ω–æ–≤–ª—ë–Ω** –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç:
- `*.conf` (–∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –∫–æ–Ω—Ñ–∏–≥–∏)
- `*-qr.png` (QR-–∫–æ–¥—ã)
- `.env` (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)
- `config/` (–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –ø—Ä–∏–≤–∞—Ç–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏)

### –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:

1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ:**
   - –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ (`PrivateKey =`)
   - –ü–∞—Ä–æ–ª–∏ (`.env`, `htpasswd`)
   - QR-–∫–æ–¥—ã —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ VPN

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env.example`:**
   ```bash
   cp .env.example .env
   # –ó–∞–ø–æ–ª–Ω–∏—Ç–µ .env —Å–≤–æ–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
   # .env –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ
   ```

3. **–•—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   - –ö–æ–Ω—Ñ–∏–≥–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤: `/opt/vpn/config/` (—Ç–æ–ª—å–∫–æ –Ω–∞ VPS)
   - –ü–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ —á–µ—Ä–µ–∑ SCP/SFTP –∏–ª–∏ QR –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
   - –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ —á–µ—Ä–µ–∑ –æ—Ç–∫—Ä—ã—Ç—ã–µ –∫–∞–Ω–∞–ª—ã (Telegram, email –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è)

---

## üîí –®–∞–≥ 4: –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Firewall (UFW):
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã
sudo ufw status

# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç —Ç–æ–ª—å–∫–æ:
# - 51820/udp (WireGuard)
# - 22/tcp (SSH)
# - 80/tcp, 443/tcp (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Apache)
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è:
```bash
# –û–±–Ω–æ–≤–ª—è–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–µ–≥—É–ª—è—Ä–Ω–æ
cd /opt/vpn
docker compose pull
docker compose up -d

# –û–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–∏—Å—Ç–µ–º—É
sudo apt update && sudo apt upgrade -y
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
```bash
# –õ–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
docker logs wireguard --tail 100 -f

# –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏
docker exec wireguard wg show
```

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç–µ –Ω–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π Issue –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–ø—Ä—è–º—É—é: https://github.com/DREDGV

**–°—Ç–∞—Ç—É—Å:** üî¥ –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π!
